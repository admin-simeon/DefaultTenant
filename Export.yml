parameters:    
  - name: Comment
    displayName: Export comment (included in Git history)
    default: '-'
    type: string    
    
  - name: MergeChanges
    displayName: Merge changes - if unchecked, configurations will be left in a Git branch and not used for subsequent deployments until merged
    default: true
    type: boolean

  - name: FileResourceProvider_AlwaysWriteToLastSource
    displayName: Override baseline - if checked, the export will save configurations to the repository that override those from the baseline
    default: false
    type: boolean

name: $(Date:yyyyMMdd)$(Rev:.r)
trigger: none

pool:
  vmImage: windows-latest

resources:
  repositories:
  - repository: AzurePipelineTemplates
    type: github
    name: simeoncloud/AzurePipelineTemplates
    ref: refs/heads/master
    endpoint: simeoncloud

extends:
  template: M365ManagementExport.yml@AzurePipelineTemplates
  parameters:
    Comment: ${{ parameters.Comment }}
    MergeChanges: ${{ parameters.MergeChanges }}
    FileResourceProvider_AlwaysWriteToLastSource: ${{ parameters.FileResourceProvider_AlwaysWriteToLastSource }}
